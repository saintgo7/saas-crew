# Plan 08-03: CI/CD íŒŒì´í”„ë¼ì¸ ì™„ì„±

---
phase: 8
plan_number: 03
goal: GitHub Actions CI/CD íŒŒì´í”„ë¼ì¸ ì™„ì„± ë° ìë™ ë°°í¬
depends_on: 08-02
parallelizable: false
estimated_tasks: 4
files_modified:
  - .github/workflows/deploy.yml
  - .github/workflows/ci.yml
  - deployments/scripts/deploy-server.sh
  - docs/CICD_GUIDE.md
---

## Context

**Current State:**
- deploy.yml ê¸°ë³¸ êµ¬ì¡° ì¡´ì¬í•˜ì§€ë§Œ ì‹¤ì œ ë°°í¬ ëª…ë ¹ì–´ placeholder ìƒíƒœ
- CI workflows (tests, lint, security) ì‘ë™ ì¤‘
- Cloudflare Pages ì„¤ì • ìˆì§€ë§Œ ë¯¸ì™„ì„±
- í•™êµ ì„œë²„ ë°°í¬ ìë™í™” ë¶€ì¬

**Depends on:**
- Plan 08-02 (docker-compose.prod.yml, ë°°í¬ ìŠ¤í¬ë¦½íŠ¸)

**Goal:**
- deploy.ymlì— ì‹¤ì œ ë°°í¬ ëª…ë ¹ì–´ êµ¬í˜„
- Cloudflare Pages ìë™ ë°°í¬ ì™„ì„±
- í•™êµ ì„œë²„ SSH ë°°í¬ ìë™í™”
- ë°°í¬ ì•Œë¦¼ (Slack/Discord)
- ë¡¤ë°± ë©”ì»¤ë‹ˆì¦˜ êµ¬í˜„

**Success Criteria:**
- [ ] main ë¸Œëœì¹˜ push ì‹œ ìë™ ë°°í¬
- [ ] Staging/Production í™˜ê²½ ë¶„ë¦¬
- [ ] í•™êµ ì„œë²„ ìë™ ë°°í¬ ì‘ë™
- [ ] Cloudflare Pages ìë™ ë°°í¬ ì‘ë™
- [ ] ë¡¤ë°± ì›Œí¬í”Œë¡œìš° ì‘ë™
- [ ] ë°°í¬ ì•Œë¦¼ ì „ì†¡

## Tasks

### Task 1: deploy.yml ì‹¤ì œ ë°°í¬ ëª…ë ¹ì–´ êµ¬í˜„

**Objective:** placeholder ìƒíƒœì¸ deploy.ymlì— ì‹¤ì œ ë°°í¬ ëª…ë ¹ì–´ ì¶”ê°€

**Steps:**
1. Read .github/workflows/deploy.yml
2. Update deploy-staging job:
   - SSH to school server
   - Pull latest code
   - Run deployment script
3. Update deploy-production job:
   - Run database migrations
   - Deploy to school server
   - Health check verification
4. Add secrets configuration guide
5. Add deployment status notifications

**Code to Update (deploy.yml):**
```yaml
# Line 196-207: Replace placeholder with actual deployment
deploy-staging:
  name: Deploy to Staging
  runs-on: ubuntu-latest
  needs: [build-api, build-web]
  if: github.event_name == 'push' || github.event.inputs.environment == 'staging'
  environment:
    name: staging
    url: https://staging.wku-crew.com

  steps:
    - name: Checkout code
      uses: actions/checkout@v4

    - name: Setup SSH
      uses: webfactory/ssh-agent@v0.9.0
      with:
        ssh-private-key: ${{ secrets.SCHOOL_SERVER_SSH_KEY }}

    - name: Add server to known hosts
      run: |
        mkdir -p ~/.ssh
        ssh-keyscan -H ${{ secrets.SCHOOL_SERVER_HOST }} >> ~/.ssh/known_hosts

    - name: Deploy API to School Server (Staging)
      run: |
        echo "ğŸš€ Deploying to staging server..."
        ssh ${{ secrets.SCHOOL_SERVER_USER }}@${{ secrets.SCHOOL_SERVER_HOST }} << 'EOF'
          cd /opt/saas-crew
          git fetch origin
          git checkout main
          git pull origin main

          # Pull latest images
          docker-compose -f docker-compose.prod.yml pull

          # Rebuild API image
          docker-compose -f docker-compose.prod.yml build api

          # Restart services
          docker-compose -f docker-compose.prod.yml up -d

          # Run migrations
          docker-compose -f docker-compose.prod.yml exec -T api pnpm db:migrate:deploy

          # Health check
          sleep 10
          curl -f http://localhost:4000/api/health || exit 1
        EOF
        echo "âœ… Staging deployment completed"

    - name: Deploy Frontend to Cloudflare Pages (Staging)
      uses: cloudflare/wrangler-action@v3
      with:
        apiToken: ${{ secrets.CLOUDFLARE_API_TOKEN }}
        accountId: ${{ secrets.CLOUDFLARE_ACCOUNT_ID }}
        command: pages deploy apps/web/.next --project-name=wku-crew-web-staging

    - name: Send deployment notification
      if: always()
      uses: 8398a7/action-slack@v3
      with:
        status: ${{ job.status }}
        text: |
          ğŸš€ Staging Deployment: ${{ job.status }}
          Commit: ${{ github.sha }}
          Author: ${{ github.actor }}
          URL: https://staging.wku-crew.com
        webhook_url: ${{ secrets.SLACK_WEBHOOK_URL }}
      env:
        SLACK_WEBHOOK_URL: ${{ secrets.SLACK_WEBHOOK_URL }}

# Line 232-296: Update production deployment
deploy-production:
  name: Deploy to Production
  runs-on: ubuntu-latest
  needs: [build-api, build-web, deploy-staging]
  if: github.event.inputs.environment == 'production'
  environment:
    name: production
    url: https://wku-crew.com

  steps:
    - name: Checkout code
      uses: actions/checkout@v4

    - name: Setup SSH
      uses: webfactory/ssh-agent@v0.9.0
      with:
        ssh-private-key: ${{ secrets.SCHOOL_SERVER_SSH_KEY }}

    - name: Add server to known hosts
      run: |
        mkdir -p ~/.ssh
        ssh-keyscan -H ${{ secrets.SCHOOL_SERVER_HOST }} >> ~/.ssh/known_hosts

    - name: Create database backup
      run: |
        echo "ğŸ’¾ Creating database backup..."
        ssh ${{ secrets.SCHOOL_SERVER_USER }}@${{ secrets.SCHOOL_SERVER_HOST }} << 'EOF'
          cd /opt/saas-crew
          ./deployments/scripts/backup.sh
        EOF

    - name: Deploy to Production Server
      run: |
        echo "ğŸš€ Deploying to production server..."
        ssh ${{ secrets.SCHOOL_SERVER_USER }}@${{ secrets.SCHOOL_SERVER_HOST }} << 'EOF'
          cd /opt/saas-crew

          # Pull latest code
          git fetch origin
          git checkout main
          git pull origin main

          # Stop services gracefully
          docker-compose -f docker-compose.prod.yml stop api

          # Pull and rebuild
          docker-compose -f docker-compose.prod.yml pull
          docker-compose -f docker-compose.prod.yml build api

          # Run migrations (before starting new version)
          docker-compose -f docker-compose.prod.yml run --rm api pnpm db:migrate:deploy

          # Start all services
          docker-compose -f docker-compose.prod.yml up -d

          # Wait for services to be ready
          sleep 15
        EOF
        echo "âœ… Production deployment completed"

    - name: Verify deployment health
      run: |
        echo "ğŸ” Verifying deployment health..."
        for i in {1..10}; do
          if ssh ${{ secrets.SCHOOL_SERVER_USER }}@${{ secrets.SCHOOL_SERVER_HOST }} \
             "curl -sf http://localhost:4000/api/health" > /dev/null; then
            echo "âœ… Health check passed"
            exit 0
          fi
          echo "Attempt $i failed, retrying..."
          sleep 10
        done
        echo "âŒ Health check failed"
        exit 1

    - name: Deploy Frontend to Cloudflare Pages (Production)
      uses: cloudflare/wrangler-action@v3
      with:
        apiToken: ${{ secrets.CLOUDFLARE_API_TOKEN }}
        accountId: ${{ secrets.CLOUDFLARE_ACCOUNT_ID }}
        command: pages deploy apps/web/.next --project-name=wku-crew-web --branch=main

    - name: Create deployment tag
      run: |
        TAG_NAME="deploy-$(date +%Y%m%d-%H%M%S)"
        git tag $TAG_NAME
        git push origin $TAG_NAME

    - name: Send success notification
      if: success()
      uses: 8398a7/action-slack@v3
      with:
        status: custom
        custom_payload: |
          {
            text: "âœ… Production Deployment Successful",
            attachments: [{
              color: 'good',
              text: `Commit: ${{ github.sha }}\nAuthor: ${{ github.actor }}\nURL: https://wku-crew.com`
            }]
          }
        webhook_url: ${{ secrets.SLACK_WEBHOOK_URL }}

    - name: Send failure notification
      if: failure()
      uses: 8398a7/action-slack@v3
      with:
        status: custom
        custom_payload: |
          {
            text: "âŒ Production Deployment Failed",
            attachments: [{
              color: 'danger',
              text: `Commit: ${{ github.sha }}\nAuthor: ${{ github.actor }}\nPlease check logs immediately!`
            }]
          }
        webhook_url: ${{ secrets.SLACK_WEBHOOK_URL }}
```

**Files to Update:**
- .github/workflows/deploy.yml (major update)

**Expected Output:**
- ì™„ì „í•œ ìë™ ë°°í¬ íŒŒì´í”„ë¼ì¸
- Staging/Production ë¶„ë¦¬
- ë°°í¬ ì•Œë¦¼ ì „ì†¡

---

### Task 2: ë¡¤ë°± ì›Œí¬í”Œë¡œìš° êµ¬í˜„

**Objective:** ë°°í¬ ì‹¤íŒ¨ ì‹œ ìë™/ìˆ˜ë™ ë¡¤ë°± ë©”ì»¤ë‹ˆì¦˜

**Steps:**
1. Create .github/workflows/rollback.yml
2. Implement automatic rollback on health check failure
3. Add manual rollback workflow (workflow_dispatch)
4. Restore database backup
5. Redeploy previous Docker image

**Code to Add (rollback.yml):**
```yaml
name: Rollback

on:
  workflow_dispatch:
    inputs:
      environment:
        description: 'Environment to rollback'
        required: true
        type: choice
        options:
          - staging
          - production
      backup_timestamp:
        description: 'Backup timestamp (optional, uses latest if empty)'
        required: false
        type: string

jobs:
  rollback:
    name: Rollback ${{ github.event.inputs.environment }}
    runs-on: ubuntu-latest
    environment:
      name: ${{ github.event.inputs.environment }}

    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Setup SSH
        uses: webfactory/ssh-agent@v0.9.0
        with:
          ssh-private-key: ${{ secrets.SCHOOL_SERVER_SSH_KEY }}

      - name: Add server to known hosts
        run: |
          mkdir -p ~/.ssh
          ssh-keyscan -H ${{ secrets.SCHOOL_SERVER_HOST }} >> ~/.ssh/known_hosts

      - name: Stop current services
        run: |
          echo "ğŸ›‘ Stopping current services..."
          ssh ${{ secrets.SCHOOL_SERVER_USER }}@${{ secrets.SCHOOL_SERVER_HOST }} << 'EOF'
            cd /opt/saas-crew
            docker-compose -f docker-compose.prod.yml down
          EOF

      - name: Restore database backup
        run: |
          BACKUP_FILE="${{ github.event.inputs.backup_timestamp }}"
          echo "ğŸ’¾ Restoring database backup..."
          ssh ${{ secrets.SCHOOL_SERVER_USER }}@${{ secrets.SCHOOL_SERVER_HOST }} << EOF
            cd /opt/saas-crew

            # Use latest backup if not specified
            if [ -z "$BACKUP_FILE" ]; then
              BACKUP_FILE=\$(ls -t backups/*.sql.gz | head -1)
            else
              BACKUP_FILE="backups/wku_crew_backup_${BACKUP_FILE}.sql.gz"
            fi

            echo "Restoring from: \$BACKUP_FILE"

            # Start postgres only
            docker-compose -f docker-compose.prod.yml up -d postgres
            sleep 5

            # Drop and recreate database
            docker-compose -f docker-compose.prod.yml exec -T postgres \
              psql -U \$DB_USER -d postgres -c "DROP DATABASE IF EXISTS \$DB_NAME"
            docker-compose -f docker-compose.prod.yml exec -T postgres \
              psql -U \$DB_USER -d postgres -c "CREATE DATABASE \$DB_NAME"

            # Restore backup
            gunzip < \$BACKUP_FILE | \
              docker-compose -f docker-compose.prod.yml exec -T postgres \
              psql -U \$DB_USER \$DB_NAME
          EOF

      - name: Restart services with previous version
        run: |
          echo "ğŸ”„ Restarting services..."
          ssh ${{ secrets.SCHOOL_SERVER_USER }}@${{ secrets.SCHOOL_SERVER_HOST }} << 'EOF'
            cd /opt/saas-crew

            # Checkout previous commit
            git reset --hard HEAD~1

            # Rebuild and restart
            docker-compose -f docker-compose.prod.yml up -d --build

            # Wait for services
            sleep 15
          EOF

      - name: Verify rollback
        run: |
          echo "ğŸ” Verifying rollback..."
          for i in {1..5}; do
            if ssh ${{ secrets.SCHOOL_SERVER_USER }}@${{ secrets.SCHOOL_SERVER_HOST }} \
               "curl -sf http://localhost:4000/api/health" > /dev/null; then
              echo "âœ… Rollback successful"
              exit 0
            fi
            echo "Attempt $i failed, retrying..."
            sleep 10
          done
          echo "âŒ Rollback verification failed"
          exit 1

      - name: Send notification
        if: always()
        uses: 8398a7/action-slack@v3
        with:
          status: custom
          custom_payload: |
            {
              text: "${{ job.status == 'success' && 'âœ…' || 'âŒ' }} Rollback ${{ job.status }}",
              attachments: [{
                color: '${{ job.status == 'success' && 'good' || 'danger' }}',
                text: `Environment: ${{ github.event.inputs.environment }}\nInitiated by: ${{ github.actor }}`
              }]
            }
          webhook_url: ${{ secrets.SLACK_WEBHOOK_URL }}
```

**Files to Create:**
- .github/workflows/rollback.yml (new)

**Expected Output:**
- ìˆ˜ë™ ë¡¤ë°± ì›Œí¬í”Œë¡œìš°
- ë°ì´í„°ë² ì´ìŠ¤ ë°±ì—… ë³µêµ¬
- ì´ì „ ë²„ì „ìœ¼ë¡œ ë³µì›

---

### Task 3: Cloudflare Pages ìë™ ë°°í¬ ì™„ì„±

**Objective:** Frontend Cloudflare Pages ë°°í¬ ì™„ì„± ë° ìµœì í™”

**Steps:**
1. Update deploy.yml Cloudflare section
2. Add build optimization for Next.js
3. Configure preview deployments
4. Set up custom domain
5. Add deployment headers

**Code to Update (deploy.yml - Cloudflare section):**
```yaml
build-web:
  name: Build Frontend
  runs-on: ubuntu-latest
  needs: test

  steps:
    - name: Checkout code
      uses: actions/checkout@v4

    - name: Setup pnpm
      uses: pnpm/action-setup@v2
      with:
        version: 8

    - name: Setup Node.js
      uses: actions/setup-node@v4
      with:
        node-version: '20'
        cache: 'pnpm'

    - name: Install dependencies
      run: pnpm install --frozen-lockfile

    - name: Build frontend (Staging)
      if: github.event_name == 'push' || github.event.inputs.environment == 'staging'
      run: pnpm --filter @wku-crew/web build
      env:
        NEXT_PUBLIC_API_URL: https://staging-api.wku-crew.com
        NEXTAUTH_URL: https://staging.wku-crew.com
        NEXTAUTH_SECRET: ${{ secrets.NEXTAUTH_SECRET_STAGING }}
        NODE_ENV: production

    - name: Build frontend (Production)
      if: github.event.inputs.environment == 'production'
      run: pnpm --filter @wku-crew/web build
      env:
        NEXT_PUBLIC_API_URL: https://api.wku-crew.com
        NEXTAUTH_URL: https://wku-crew.com
        NEXTAUTH_SECRET: ${{ secrets.NEXTAUTH_SECRET }}
        NODE_ENV: production

    - name: Upload build artifacts
      uses: actions/upload-artifact@v4
      with:
        name: web-build-${{ github.sha }}
        path: apps/web/.next
        retention-days: 7

    # Deploy to Cloudflare Pages
    - name: Deploy to Cloudflare Pages
      uses: cloudflare/wrangler-action@v3
      with:
        apiToken: ${{ secrets.CLOUDFLARE_API_TOKEN }}
        accountId: ${{ secrets.CLOUDFLARE_ACCOUNT_ID }}
        command: |
          pages deploy apps/web/out \
            --project-name=${{ github.event.inputs.environment == 'production' && 'wku-crew-web' || 'wku-crew-web-staging' }} \
            --branch=${{ github.ref_name }} \
            --commit-hash=${{ github.sha }}

    - name: Get deployment URL
      id: cf-pages
      run: |
        DEPLOY_URL="https://${{ github.event.inputs.environment == 'production' && 'wku-crew.com' || 'staging.wku-crew.com' }}"
        echo "url=$DEPLOY_URL" >> $GITHUB_OUTPUT

    - name: Comment deployment URL
      uses: actions/github-script@v7
      if: github.event_name == 'pull_request'
      with:
        script: |
          github.rest.issues.createComment({
            issue_number: context.issue.number,
            owner: context.repo.owner,
            repo: context.repo.repo,
            body: `ğŸš€ Preview deployed to: ${{ steps.cf-pages.outputs.url }}`
          })
```

**Files to Update:**
- .github/workflows/deploy.yml (Cloudflare section)

**Expected Output:**
- Next.js ìµœì í™” ë¹Œë“œ
- Cloudflare Pages ìë™ ë°°í¬
- PR preview deployments

---

### Task 4: CI/CD ê°€ì´ë“œ ë¬¸ì„œ ì‘ì„±

**Objective:** CI/CD_GUIDE.md ì‘ì„± ë° Secrets ì„¤ì • ê°€ì´ë“œ

**Steps:**
1. Create docs/CICD_GUIDE.md
2. Document GitHub Actions workflows
3. List required secrets
4. Deployment procedures
5. Troubleshooting guide

**Code to Add (CICD_GUIDE.md):**
```markdown
# CI/CD Guide - WKU Software Crew

## Overview

This project uses GitHub Actions for continuous integration and deployment.

### Workflows

1. **CI (ci.yml)** - Run on every push/PR
   - Lint code
   - Run unit tests
   - Check build

2. **E2E Tests (e2e-tests.yml)** - Run on every push/PR
   - Web E2E tests (Playwright)
   - API E2E tests (Jest)

3. **Security Scan (security-scan.yml)** - Daily + on push
   - Dependency vulnerability scan
   - OWASP security checks

4. **Performance (performance.yml)** - On push to main
   - Lighthouse CI
   - API performance benchmarks

5. **Deploy (deploy.yml)** - On push to main or manual
   - Build Docker images
   - Deploy to staging/production
   - Run migrations
   - Health checks

6. **Rollback (rollback.yml)** - Manual only
   - Restore database backup
   - Rollback to previous version

## Required GitHub Secrets

### School Server Access
```
SCHOOL_SERVER_HOST=123.456.789.012
SCHOOL_SERVER_USER=deployer
SCHOOL_SERVER_SSH_KEY=<private SSH key>
```

### Cloudflare
```
CLOUDFLARE_API_TOKEN=<your-api-token>
CLOUDFLARE_ACCOUNT_ID=<your-account-id>
```

### Notifications
```
SLACK_WEBHOOK_URL=https://hooks.slack.com/services/YOUR/WEBHOOK/URL
```

### Application Secrets
```
NEXTAUTH_SECRET=<strong-random-string-32+>
NEXTAUTH_SECRET_STAGING=<different-strong-random-string>
```

## Setting Up Secrets

1. Go to repository Settings â†’ Secrets and variables â†’ Actions
2. Click "New repository secret"
3. Add each secret from the list above

### Generating SSH Key for Deployment

```bash
# On your local machine
ssh-keygen -t ed25519 -C "github-actions-deploy" -f ~/.ssh/github_deploy

# Copy public key to school server
ssh-copy-id -i ~/.ssh/github_deploy.pub deployer@SCHOOL_SERVER_IP

# Copy private key to GitHub secrets
cat ~/.ssh/github_deploy
# Add as SCHOOL_SERVER_SSH_KEY secret
```

## Deployment Procedures

### Automatic Deployment (Staging)

1. Merge PR to `main` branch
2. GitHub Actions automatically:
   - Runs tests
   - Builds Docker image
   - Deploys to staging server
   - Sends notification

### Manual Deployment (Production)

1. Go to Actions â†’ Deploy workflow
2. Click "Run workflow"
3. Select:
   - Branch: `main`
   - Environment: `production`
4. Click "Run workflow"
5. Monitor progress
6. Verify deployment at https://wku-crew.com

### Rollback

1. Go to Actions â†’ Rollback workflow
2. Click "Run workflow"
3. Select:
   - Environment: `production` or `staging`
   - Backup timestamp: (optional, uses latest)
4. Click "Run workflow"
5. Monitor rollback progress

## Monitoring Deployments

### View Logs

```bash
# SSH to school server
ssh deployer@SCHOOL_SERVER_IP

# View API logs
docker-compose -f /opt/saas-crew/docker-compose.prod.yml logs -f api

# View all services
docker-compose -f /opt/saas-crew/docker-compose.prod.yml logs -f
```

### Check Health

```bash
# API health
curl https://api.wku-crew.com/api/health

# Swagger docs
curl https://api.wku-crew.com/api/docs
```

## Troubleshooting

### Deployment Failed - SSH Connection

**Issue:** "Permission denied (publickey)"

**Solution:**
1. Verify SSH key is added to GitHub secrets
2. Check public key is in server's `~/.ssh/authorized_keys`
3. Test SSH connection: `ssh deployer@SCHOOL_SERVER_IP`

### Deployment Failed - Health Check

**Issue:** "Health check failed after deployment"

**Solution:**
1. SSH to server
2. Check logs: `docker-compose logs api`
3. Check if services are running: `docker ps`
4. Manually test health: `curl http://localhost:4000/api/health`

### Cloudflare Pages Deployment Failed

**Issue:** "Failed to deploy to Cloudflare Pages"

**Solution:**
1. Verify CLOUDFLARE_API_TOKEN is valid
2. Check CLOUDFLARE_ACCOUNT_ID is correct
3. Verify project name matches Cloudflare dashboard

### Database Migration Failed

**Issue:** "Migration failed during deployment"

**Solution:**
1. SSH to server
2. Check migration logs
3. Manually run migration:
   ```bash
   docker-compose exec api pnpm db:migrate:deploy
   ```
4. If failed, rollback:
   ```bash
   docker-compose exec api pnpm db:migrate:rollback
   ```

## Best Practices

1. **Always test in staging first**
   - Never deploy directly to production
   - Use staging for final verification

2. **Monitor deployments**
   - Watch Slack notifications
   - Check logs immediately after deployment

3. **Regular backups**
   - Automatic backups run daily
   - Manual backup before major deployments

4. **Gradual rollout**
   - Deploy during low-traffic hours
   - Monitor metrics after deployment

5. **Rollback plan**
   - Know how to rollback quickly
   - Keep recent backups accessible

## Contact

For CI/CD issues:
- DevOps Lead: devops@wku-crew.com
- GitHub Issues: https://github.com/wku-crew/saas-crew/issues
```

**Files to Create:**
- docs/CICD_GUIDE.md (new, ~350 lines)

**Expected Output:**
- ì™„ì „í•œ CI/CD ê°€ì´ë“œ
- Secrets ì„¤ì • ë°©ë²•
- íŠ¸ëŸ¬ë¸”ìŠˆíŒ… ê°€ì´ë“œ

---

## Dependencies

**Depends on:**
- Plan 08-02 (docker-compose.prod.yml, ë°°í¬ ìŠ¤í¬ë¦½íŠ¸)

**Before Starting:**
- [ ] GitHub repository secrets ì„¤ì •
- [ ] í•™êµ ì„œë²„ SSH ì ‘ê·¼ ì„¤ì •
- [ ] Cloudflare Pages í”„ë¡œì íŠ¸ ìƒì„±

**After Completion:**
- GitHub Actionsë¡œ ìë™ ë°°í¬ ê°€ëŠ¥
- Staging/Production í™˜ê²½ ë¶„ë¦¬ ì™„ë£Œ
- ë¡¤ë°± ë©”ì»¤ë‹ˆì¦˜ ì‘ë™

---

## Validation Checklist

- [ ] deploy.yml ì‹¤ì œ ë°°í¬ ëª…ë ¹ì–´ êµ¬í˜„
- [ ] Staging ìë™ ë°°í¬ ì„±ê³µ
- [ ] Production ìˆ˜ë™ ë°°í¬ ì„±ê³µ
- [ ] í•™êµ ì„œë²„ SSH ë°°í¬ ì‘ë™
- [ ] Cloudflare Pages ìë™ ë°°í¬ ì‘ë™
- [ ] ë¡¤ë°± ì›Œí¬í”Œë¡œìš° í…ŒìŠ¤íŠ¸ ì„±ê³µ
- [ ] ë°°í¬ ì•Œë¦¼ Slack ì „ì†¡ í™•ì¸
- [ ] CICD_GUIDE.md ì‘ì„± ì™„ë£Œ

---

## Success Metrics

| Metric | Target | Measurement |
|--------|--------|-------------|
| Deployment Automation | 100% | Manual steps eliminated |
| Deployment Time | <10 min | Time from push to live |
| Rollback Time | <5 min | Time to restore service |
| Deployment Success Rate | >95% | Successful deployments |
| Notification Delivery | 100% | Slack messages sent |

---

## Risks and Mitigation

**Risk 1:** SSH key ìœ ì¶œ
- **Mitigation:** Rotate keys regularly, use dedicated deploy user with minimal permissions

**Risk 2:** Cloudflare API rate limit
- **Mitigation:** Implement deployment throttling, use manual approval for production

**Risk 3:** ë™ì‹œ ë°°í¬ ì¶©ëŒ
- **Mitigation:** GitHub Actions concurrency control, deployment queue

---

## Next Steps

After completing this plan:
1. Test complete deployment flow
2. Configure Slack notifications
3. Set up monitoring dashboard (Plan 08-04)
4. Beta tester onboarding (Plan 08-04)

---

**Plan Owner:** DevOps Team
**Reviewers:** Backend Team, Infrastructure Team
**Estimated Duration:** 5-7 hours
**Priority:** Critical (ë² íƒ€ ëŸ°ì¹­ í•„ìˆ˜)
